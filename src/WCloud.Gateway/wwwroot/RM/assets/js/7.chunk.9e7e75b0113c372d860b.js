(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{645:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"col-md-12"},[a("div",{staticClass:"top"},[a("el-button",{staticClass:"btnback",attrs:{plain:""},on:{click:e.onbackList}},[e._v(" 返回")])],1),e._v(" "),a("div",{staticClass:"col-md-8 left"},[a("div",{staticClass:"col-md-12 note note-success box-note-success"},[a("ul",{staticClass:"record_total_info_ul"},[a("li",{staticClass:"record_total_info_li"},[a("span",{staticClass:"name"},[e._v("当前位置: ")]),e._v(" "),a("span",{attrs:{id:"span_current_pos"}},[e._v(e._s(e.bookId))])]),e._v(" "),a("li",{staticClass:"record_total_info_li"},[a("span",{staticClass:"name"},[e._v("总数: ")]),e._v(" "),a("span",{attrs:{id:"span_total"}},[e._v(e._s(e.cardtotal))])]),e._v(" "),a("li",{staticClass:"record_total_info_li"},[a("span",{staticClass:"name"},[e._v("已录入: ")]),e._v(" "),a("span",{attrs:{id:"span_read"}},[e._v(e._s(e.read))])]),e._v(" "),a("li",{staticClass:"record_total_info_li"},[a("span",{staticClass:"name"},[e._v("未录入: ")]),e._v(" "),a("span",{attrs:{id:"span_not_read"}},[e._v(e._s(e.notread))])])])]),e._v(" "),a("div",{staticClass:"col-md-12"},[a("div",{staticClass:"form-group select"},[a("div",{staticClass:"col-md-6"},[a("el-input",{staticClass:"col-md-10",attrs:{placeholder:"请输入表卡编号"},model:{value:e.cardid,callback:function(t){e.cardid=t},expression:"cardid"}}),e._v(" "),a("el-button",{attrs:{icon:"el-icon-search",circle:""},on:{click:function(t){return e.getreading()}}})],1),e._v(" "),a("div",{staticClass:"col-md-6 checkbox"},[a("el-checkbox",{on:{change:function(t){return e.checkstate()}},model:{value:e.checked,callback:function(t){e.checked=t},expression:"checked"}},[e._v("只显示未抄")])],1)])]),e._v(" "),a("div",{staticClass:"tableDiv"},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.readings},on:{"row-click":e.clickrow}},[a("el-table-column",{attrs:{prop:"bookSortIndex",label:"序号"}}),e._v(" "),a("el-table-column",{attrs:{prop:"cardID",label:"表卡编号",width:"200"}}),e._v(" "),a("el-table-column",{attrs:{prop:"cardName",label:"户名",width:"280"}}),e._v(" "),a("el-table-column",{attrs:{prop:"cardAddress",label:"地址",width:"280"}}),e._v(" "),a("el-table-column",{attrs:{prop:"lastReading",label:"上次抄码"}}),e._v(" "),a("el-table-column",{attrs:{prop:"reading",label:"本次抄码"}}),e._v(" "),a("el-table-column",{attrs:{prop:"readWater",label:"抄见水量"}}),e._v(" "),a("el-table-column",{attrs:{prop:"readStateCN",label:"抄表状态"}}),e._v(" "),a("el-table-column",{attrs:{fixed:"right",label:"操作",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text",size:"small"},on:{click:[function(a){return e.handleClick(t.row)},function(t){t.stopPropagation(),e.deleteVisible=!0}]}},[e._v("日志")]),e._v(" "),a("el-popover",{attrs:{placement:"right",width:"400",trigger:"click"}},[a("el-carousel",{attrs:{interval:5e3,arrow:"always"}},e._l(e.images,function(t){return a("el-carousel-item",{key:t.url},[a("el-image",{staticClass:"attach_file",attrs:{src:t.url,fit:e.fit}})],1)}),1),e._v(" "),a("el-button",{attrs:{slot:"reference",type:"text",size:"small"},on:{click:function(a){return e.getimages(t.row.recordID)}},slot:"reference"},[e._v("附件")])],1)]}}])})],1),e._v(" "),a("el-pagination",{staticClass:"blistfoot",attrs:{"current-page":1,"page-sizes":[10,50,100],"page-size":10,layout:"total, sizes, prev, pager, next",total:e.total,center:"true"},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)]),e._v(" "),a("div",{staticClass:"col-md-4 right"},[a("div",{staticClass:"right-top col-md-12 "},[e._m(0),e._v(" "),a("div",{staticClass:"topFrom col-md-12"},[a("el-form",{ref:"reading",attrs:{"label-position":e.labelPosition,"label-width":"80px",model:e.reading,rules:e.rules}},[a("el-form-item",{attrs:{label:"上次抄码"}},[a("el-input",{attrs:{disabled:!0},model:{value:e.reading.lastreading,callback:function(t){e.$set(e.reading,"lastreading",t)},expression:"reading.lastreading"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"本次抄码"}},[a("el-input",{model:{value:e.reading.reading,callback:function(t){e.$set(e.reading,"reading",t)},expression:"reading.reading"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"抄表状态"}},[a("el-select",{attrs:{placeholder:"请选择抄表状态"},model:{value:e.reading.readState,callback:function(t){e.$set(e.reading,"readState",t)},expression:"reading.readState"}},e._l(e.options,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"抄表水量",prop:"readWater"}},[a("el-input",{model:{value:e.reading.readWater,callback:function(t){e.$set(e.reading,"readWater",t)},expression:"reading.readWater"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"抄表日期"}},[a("el-date-picker",{attrs:{type:"date",placeholder:"选择日期","value-format":"yyyy-MM-dd"},model:{value:e.reading.readDate,callback:function(t){e.$set(e.reading,"readDate",t)},expression:"reading.readDate"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"抄表备注"}},[a("el-input",{attrs:{type:"textarea"},model:{value:e.reading.recordRemark,callback:function(t){e.$set(e.reading,"recordRemark",t)},expression:"reading.recordRemark"}})],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.onSubmit("reading")}}},[e._v("保存")])],1)],1)],1)]),e._v(" "),a("div",{staticClass:"col-md-12 right-bottom"},[a("div",{attrs:{id:"portlet_cust_container"}},[a("div",{staticClass:"portlet box grey"},[e._m(1),e._v(" "),a("div",{staticClass:"portlet-body"},[a("div",{staticClass:"form-horizontal"},[a("div",{staticClass:"form-body"},[a("div",{staticClass:"row"},[a("div",{staticClass:"col-md-12"},[a("div",{staticClass:"form-group"},[a("label",{staticClass:"col-sm-4 control-label"},[e._v("\n                          用户名称\n                        ")]),e._v(" "),a("label",{staticClass:"col-sm-8  control-label info-lebel-left",attrs:{id:"cust_customer_name"}},[e._v(e._s(e.cardinfo.cardName))])])])]),e._v(" "),a("div",{staticClass:"row"},[a("div",{staticClass:"col-md-12"},[a("div",{staticClass:"form-group"},[a("label",{staticClass:"col-sm-4 control-label"},[e._v("\n                          客户地址\n                        ")]),e._v(" "),a("label",{staticClass:"col-sm-8  control-label info-lebel-left",attrs:{id:"cust_customer_address"}},[e._v(e._s(e.cardinfo.cardAddress))])])])]),e._v(" "),a("div",{staticClass:"row"},[a("div",{staticClass:"col-md-12"},[a("div",{staticClass:"form-group"},[a("label",{staticClass:"col-sm-4 control-label"},[e._v("\n                          换表日期\n                        ")]),e._v(" "),a("label",{staticClass:"col-sm-8  control-label info-lebel-left",attrs:{id:"cust_meter_replace_date"}},[e._v(e._s(e.cardinfo.meterreplacedate))])])])])])])])])])])])])};r._withStripped=!0;a(132),a(692);var i=a(4);var s={name:"reading",data:()=>({labelPosition:"left",reading:{recordID:"",reading:0,readState:null,readStateCN:"",meterReader:"",lastreading:0,readWater:0,recordRemark:"",sealNumber:"",barcode:"",readDate:""},cardinfo:{cardName:"",cardAddress:"",pricecode:"",oldreading:0,startreading:0,meterreplacedate:""},images:[],options:[{value:0,label:"正常"},{value:1,label:"其他"}],rules:{readWater:[{required:!0,message:"请输入抄见水量",trigger:"blur"}]},cardid:"",total:1e3,pagesize:10,currentPage:1,readings:[],bookId:"",cardtotal:0,read:0,notread:0,billingMonth:0,readState:-1,checked:!1}),methods:{install(){this.bookId=this.$route.params.bookId,this.cardtotal=this.$route.params.totalCount,this.read=this.$route.params.readCount,this.notread=this.$route.params.unReadCount,this.billingMonth=this.$route.params.billingMonth,this.getReadings()},getReadings(){var e=this;e.checked?e.readState=0:e.readState=-1,e.$dataService.getReading(e.cardid,e.readState,e.bookId,e.billingMonth,e.currentPage,e.pagesize).then(t=>{t.authovertime?e.$AuthorizeService.logout(e).then(()=>{e.$router.replace({name:"Login"})}):(e.readings=t.data.rowData,e.total=t.data.rowCount)}).catch(function(e){console.log(e)})},handleClick(e){this.$router.replace({name:"ReadingLog",params:{recordid:e.recordID,bookID:e.bookID,totalCount:this.cardtotal,unReadCount:this.notread,readCount:this.read,billingMonth:this.billingMonth}})},onSubmit(e){var t=this;0==t.reading.readState?t.reading.readStateCN="正常":t.reading.readStateCN="其他",t.$refs[e].validate(e=>{if(!e)return!1;t.$dataService.postReading(t.reading).then(e=>{e.authovertime?t.$AuthorizeService.logout(t).then(()=>{t.$router.replace({name:"Login"})}):0==e.code?(alert("抄表成功"),this.getReadings()):alert("抄表失败")}).catch(function(e){console.log(e)})})},getreading(){this.getReadings()},clickrow(e){let t=this;t.reading.lastreading=e.lastReading,t.reading.reading=e.reading,t.reading.readState=e.readState,t.reading.readWater=e.readWater,t.reading.readDate=null==e.readDate||""==e.readDate?t.$untils.formatDate(new Date,"YYYY-MM-DD"):e.readDate,t.reading.recordRemark=e.recordRemark,t.reading.recordID=e.recordID,t.cardinfo.cardName=e.cardName,t.cardinfo.cardAddress=e.cardAddress,t.cardinfo.pricecode=e.PriceCode,t.cardinfo.oldreading=e.TerminateReading,t.cardinfo.startreading=e.InitiateReading,i.$untils?t.cardinfo.meterreplacedate=i.$untils.formatDate(e.MeterReplaceDate,"YYYY-MM-DD"):this.$untils&&(t.cardinfo.meterreplacedate=this.$untils.formatDate(e.MeterReplaceDate,"YYYY-MM-DD"))},handleCurrentChange:function(e){this.currentPage=e,this.getReadings()},handleSizeChange:function(e){this.pagesize=e,this.getReadings()},onbackList(){this.$router.replace({name:"ReadingList"})},checkstate(){this.getReadings()},getimages(e){var t=this;t.$dataService.getRecordingAttachment(e).then(e=>{e.authovertime?t.$AuthorizeService.logout(t).then(()=>{t.$router.replace({name:"Login"})}):t.images=e.data.rowData}).catch(function(e){console.log(e)})}},created:function(){this.install()}},l=(a(693),a(648)),n=Object(l.a)(s,r,[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"portlet-title col-md-12"},[t("div",{staticClass:"caption"},[t("i",{staticClass:"fa fa-reorder"}),this._v("抄表录入")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"portlet-title"},[t("div",{staticClass:"caption"},[t("i",{staticClass:"fa fa-reorder"}),this._v("客户信息")]),this._v(" "),t("div",{staticClass:"tools"},[t("a",{staticClass:"collapse",attrs:{href:"javascript:;"}})])])}],!1,null,null,null);n.options.__file="src/web/views/reading/reading.vue";t.default=n.exports},648:function(e,t,a){"use strict";function r(e,t,a,r,i,s,l,n){var o,d="function"==typeof e?e.options:e;if(t&&(d.render=t,d.staticRenderFns=a,d._compiled=!0),r&&(d.functional=!0),s&&(d._scopeId="data-v-"+s),l?(o=function(e){(e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),i&&i.call(this,e),e&&e._registeredComponents&&e._registeredComponents.add(l)},d._ssrRegister=o):i&&(o=n?function(){i.call(this,this.$root.$options.shadowRoot)}:i),o)if(d.functional){d._injectStyles=o;var c=d.render;d.render=function(e,t){return o.call(t),c(e,t)}}else{var u=d.beforeCreate;d.beforeCreate=u?[].concat(u,o):[o]}return{exports:e,options:d}}a.d(t,"a",function(){return r})},659:function(e,t,a){},692:function(e){e.exports={}},693:function(e,t,a){"use strict";var r=a(659);a.n(r).a}}]);