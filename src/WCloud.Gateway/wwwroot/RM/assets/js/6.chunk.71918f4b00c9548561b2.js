(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{647:function(e,t,l){"use strict";l.r(t);var a=function(){var e=this,t=e.$createElement,l=e._self._c||t;return l("div",[l("el-row",{staticClass:"blisthead"},[l("el-col",{staticClass:"blistheadLeft"},[l("div",{staticClass:"grid-content"},[e._v("抄表录入")])]),e._v(" "),l("el-col",{staticClass:"blistheadRight"},[l("div",{staticClass:"blistheadRightL"},[l("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.query}},[e._v("查询")]),e._v(" "),l("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.exportExcel}},[e._v("导出抄表")])],1),e._v(" "),l("el-upload",{staticClass:"upload-demo",attrs:{action:"http://localhost:28081/scp/v1/readmeter/reading/file","file-list":e.fileList,"on-change":e.handleChange,"on-exceed":e.handleExceed,"on-remove":e.handleRemove,"before-remove":e.beforeRemove,"on-success":e.successFile,"on-error":e.errorFile,headers:e.headers,accept:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, application/vnd.ms-excel","auto-upload":!0,"show-file-list":!1,multiple:!1}},[l("el-button",{attrs:{size:"small",type:"primary"}},[e._v("导入远传表数据")])],1)],1)],1),e._v(" "),l("el-row",{staticClass:"blistselect blistLeftBlank"},[l("label",[e._v("册本编号")]),e._v(" "),l("el-input",{staticClass:"blistselectTxt",staticStyle:{display:"inline-block"},attrs:{placeholder:"请输入册本编号"},model:{value:e.book,callback:function(t){e.book=t},expression:"book"}}),e._v(" "),l("label",[e._v("抄表周期")]),e._v(" "),l("el-input",{staticClass:"blistselectTxt",staticStyle:{display:"inline-block"},attrs:{placeholder:"请输入抄表周期"},model:{value:e.meterCycleZCN,callback:function(t){e.meterCycleZCN=t},expression:"meterCycleZCN"}})],1),e._v(" "),l("el-table",{staticClass:"blistTable",attrs:{data:e.tableData,"default-sort":{prop:"bookId",order:"ascending"}}},[l("el-table-column",{attrs:{prop:"bookID",label:"册本编号","min-width":"6%"}}),e._v(" "),l("el-table-column",{attrs:{prop:"bookName",label:"册本名称","min-width":"28%"}}),e._v(" "),l("el-table-column",{attrs:{prop:"billingMonth",label:"账务年月","min-width":"28%"}}),e._v(" "),l("el-table-column",{attrs:{prop:"meterCycle",label:"抄表周期",formatter:e.meterCycleCN,"min-width":"8%"}}),e._v(" "),l("el-table-column",{attrs:{prop:"cardCount",label:"表卡数","min-width":"5%"}}),e._v(" "),l("el-table-column",{attrs:{prop:"unReadCount",label:"未抄数","min-width":"5%"}}),e._v(" "),l("el-table-column",{attrs:{prop:"readCount",label:"已抄数","min-width":"5%"}}),e._v(" "),l("el-table-column",{attrs:{prop:"readStateCn",label:"抄表状态","min-width":"8%"}}),e._v(" "),l("el-table-column",{attrs:{label:"操作","min-width":"5%"},scopedSlots:e._u([{key:"default",fn:function(t){return[l("el-button",{attrs:{type:"text",size:"small"},on:{click:function(l){return e.goReading(t.row)}}},[e._v("抄表")])]}}])})],1),e._v(" "),l("el-pagination",{staticClass:"blistfoot",attrs:{"current-page":1,"page-sizes":[10,50,100],"page-size":5,layout:"total, sizes, prev, pager, next",total:e.total,center:"true"},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)};a._withStripped=!0;l(696),l(697),l(704);var o=l(17),n=l.n(o),i=(l(705),l(708),{data(){var e=this.$token.loadToken();return{total:1e3,pagesize:10,currentPage:1,tableData:[],fileList:[],subcom:"",book:"",reader:"",readDay:"",recordMethod:"",meterCycle:"",meterCycleZCN:"",exportExcelfile:"",headers:{Authorization:"Bearer "+e.access_token,selected_org_uid:e.org_id}}},created:function(){this.install()},methods:{install(){var e=this;e.$dataService.getReadingRecrod(e.subcom,e.book,e.reader,e.readDay,e.meterCycle,e.currentPage,e.pagesize).then(t=>{t.authovertime?e.$AuthorizeService.logout(e).then(()=>{e.$router.replace({name:"Login"})}):(e.tableData=t.data.rowData,e.total=t.data.rowCount)}).catch(function(e){console.log(e)})},handleCurrentChange:function(e){this.currentPage=e,this.install(),console.log(this.tableData)},handleSizeChange:function(e){this.pagesize=e,this.install()},meterCycleCN(e,t,l){let a=e.meterCycle;return-2==a?"每月三次抄":1==a?"单数月抄":2==a?"双数月抄":3==a?"每隔三个月抄":4==a?"一月多抄":"每月抄"},goReading:function(e){this.$router.replace({name:"Reading",params:{bookId:e.bookID,totalCount:e.cardCount,unReadCount:e.unReadCount,readCount:e.readCount,billingMonth:e.billingMonth}})},getdata:function(e,t,l,a){var o=[];return n.a.get(e).then(function(e){(e=""==t?e:e[t]).forEach(e=>{var t={};t.text=e[l],t.value=e[a],o.push(t)})}),o},query:function(){"每月三次抄"==this.meterCycleZCN?this.meterCycle=-2:"单数月抄"==this.meterCycleZCN?this.meterCycle=1:"双数月抄"==this.meterCycleZCN?this.meterCycle=2:"每隔三个月抄"==this.meterCycleZCN?this.meterCycle=3:"一月多抄"==this.meterCycleZCN?this.meterCycle=4:"每月抄"==this.meterCycleZCN?this.meterCycle=0:this.meterCycle="",this.install()},handleChange(e,t){},handleExceed(e,t){this.$message.warning(`当前限制选择 1 个文件，本次选择了 ${e.length} 个文件，共选择了 ${t.length} 个文件`)},handleRemove(e,t){this.fileTemp=null},beforeRemove(e,t){return this.$confirm(`确定移除 ${e.name}？`)},exportExcel(){var e=this;e.$dataService.getReadingexportExcel(e.subcom,e.book,e.reader,e.readDay,e.meterCycle).then(t=>{if(console.log(t),t.authovertime)e.$AuthorizeService.logout(e).then(()=>{e.$router.replace({name:"Login"})});else{e.exportExcelfile=t,console.log(t);var l=new Blob([t],{type:"Files"}),a=URL.createObjectURL(l),o=document.createElement("a");o.href=a,o.download=e.$untils.formatDate(new Date,"YYYYMMDDhhmmm")+".xlsx",o.click()}}).catch(function(e){console.log(e)})},successFile(e){0==e.code?(alert("上传成功"),this.install()):alert("上传失败")},errorFile(){alert("上传失败,请查看导入格式")}}}),r=(l(722),l(648)),s=Object(r.a)(i,a,[],!1,null,null,null);s.options.__file="src/web/views/readinglist/readinglist.vue";t.default=s.exports},661:function(e,t,l){},665:function(e,t){},696:function(e){e.exports={}},702:function(e,t){},703:function(e,t){},711:function(e,t){},713:function(e,t){},722:function(e,t,l){"use strict";var a=l(661);l.n(a).a}}]);